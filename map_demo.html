<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
        #map-canvas{height: 90%;}
        .labels {
            color: white;
            font-family: "Lucida Grande", "Arial", sans-serif;
            font-size: 10px;
            text-align: center;
            
            white-space: nowrap;
            display: block;
            padding: 2px;
        }
        .map-marker{
            background: red;
            color: white;
        }
    </style>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB7ykdYh43znlu-2NL7TGLcMZUYGLlZX18">
    </script>

    <script type="text/javascript" src="markerwithlabel.js"></script>


</head>
<body>
    
    <script type="text/javascript" charset="utf-8">
        var buildings = [
            {
                "longitude": -74.793129,
                "latitude": 39.909852,
                "address": "112 Monument Walk, Highland, California, 7095",
                "phone": "+1 (944) 585-3218",
                "name": "Simmons Building",
                "picture": "http://placehold.it/32x32",
                "count": 0
            },
            {
                "longitude": -72.990677,
                "latitude": 41.103718,
                "address": "585 Canda Avenue, Gilmore, Palau, 4730",
                "phone": "+1 (931) 508-3289",
                "name": "Oneal Building",
                "picture": "http://placehold.it/32x32",
                "count": 1
            },
            {
                "longitude": -74.141089,
                "latitude": 39.920133,
                "address": "176 Hudson Avenue, Sanders, Louisiana, 1647",
                "phone": "+1 (922) 548-3925",
                "name": "Mueller Building",
                "picture": "http://placehold.it/32x32",
                "count": 2
            },
            {
                "longitude": -74.039058,
                "latitude": 39.128714,
                "address": "477 Grand Avenue, Hillsboro, West Virginia, 6169",
                "phone": "+1 (818) 493-2620",
                "name": "Lancaster Building",
                "picture": "http://placehold.it/32x32",
                "count": 3
            },
            {
                "longitude": -74.475173,
                "latitude": 39.701036,
                "address": "113 Huron Street, Omar, Tennessee, 2218",
                "phone": "+1 (930) 494-2722",
                "name": "Rich Building",
                "picture": "http://placehold.it/32x32",
                "count": 4
            },
            {
                "longitude": -74.184086,
                "latitude": 41.138581,
                "address": "579 Harrison Avenue, Corinne, Oklahoma, 9067",
                "phone": "+1 (992) 403-3828",
                "name": "Klein Building",
                "picture": "http://placehold.it/32x32",
                "count": 5
            },
            {
                "longitude": -74.950454,
                "latitude": 41.133048,
                "address": "612 Woodrow Court, Coultervillle, North Carolina, 1388",
                "phone": "+1 (800) 599-3281",
                "name": "Franks Building",
                "picture": "http://placehold.it/32x32",
                "count": 6
            },
            {
                "longitude": -74.479914,
                "latitude": 39.740549,
                "address": "911 Locust Street, Brewster, Hawaii, 9000",
                "phone": "+1 (918) 414-3778",
                "name": "Garrison Building",
                "picture": "http://placehold.it/32x32",
                "count": 7
            },
            {
                "longitude": -74.980027,
                "latitude": 39.751323,
                "address": "276 Tompkins Place, Lewis, Missouri, 215",
                "phone": "+1 (915) 436-2187",
                "name": "Fulton Building",
                "picture": "http://placehold.it/32x32",
                "count": 8
            },
            {
                "longitude": -74.58445,
                "latitude": 41.124277,
                "address": "818 Wythe Place, Finzel, New Hampshire, 7963",
                "phone": "+1 (943) 524-3772",
                "name": "Mitchell Building",
                "picture": "http://placehold.it/32x32",
                "count": 9
            },
            {
                "longitude": -74.644088,
                "latitude": 39.63981,
                "address": "359 Dearborn Court, Babb, Pennsylvania, 4697",
                "phone": "+1 (864) 534-3403",
                "name": "Cooke Building",
                "picture": "http://placehold.it/32x32",
                "count": 10
            },
            {
                "longitude": -74.250963,
                "latitude": 41.03309,
                "address": "668 Gunther Place, Bentonville, Vermont, 6345",
                "phone": "+1 (850) 497-2097",
                "name": "Greer Building",
                "picture": "http://placehold.it/32x32",
                "count": 11
            },
            {
                "longitude": -74.730682,
                "latitude": 41.066584,
                "address": "551 Lacon Court, Cochranville, Federated States Of Micronesia, 5881",
                "phone": "+1 (804) 497-3321",
                "name": "Johnson Building",
                "picture": "http://placehold.it/32x32",
                "count": 12
            },
            {
                "longitude": -74.521107,
                "latitude": 39.322093,
                "address": "615 Abbey Court, Convent, Northern Mariana Islands, 964",
                "phone": "+1 (845) 520-3508",
                "name": "Jackson Building",
                "picture": "http://placehold.it/32x32",
                "count": 13
            },
            {
                "longitude": -74.608932,
                "latitude": 39.730504,
                "address": "880 Havemeyer Street, Belvoir, Arizona, 4453",
                "phone": "+1 (921) 473-2482",
                "name": "Woodard Building",
                "picture": "http://placehold.it/32x32",
                "count": 14
            },
            {
                "longitude": -74.500107,
                "latitude": 39.32317,
                "address": "506 Oxford Walk, Dragoon, New Jersey, 9698",
                "phone": "+1 (961) 476-2777",
                "name": "Hart Building",
                "picture": "http://placehold.it/32x32",
                "count": 15
            },
            {
                "longitude": -74.081032,
                "latitude": 39.875597,
                "address": "343 Commercial Street, Masthope, Maine, 8427",
                "phone": "+1 (952) 504-2519",
                "name": "Knight Building",
                "picture": "http://placehold.it/32x32",
                "count": 16
            },
            {
                "longitude": -74.777264,
                "latitude": 39.708394,
                "address": "126 Oliver Street, Ferney, Arkansas, 3228",
                "phone": "+1 (921) 468-3104",
                "name": "Roth Building",
                "picture": "http://placehold.it/32x32",
                "count": 17
            },
            {
                "longitude": -74.897453,
                "latitude": 39.034612,
                "address": "136 Bristol Street, Volta, Montana, 2912",
                "phone": "+1 (959) 531-2375",
                "name": "English Building",
                "picture": "http://placehold.it/32x32",
                "count": 18
            }
        ];

        var parking = [
            {
                "longitude": -74.903037,
                "latitude": 39.923221,
                "address": "363 Banner Avenue, Brantleyville, Hawaii, 9011",
                "phone": "+1 (984) 568-3097",
                "name": "Brennan Parking",
                "picture": "http://placehold.it/32x32",
                "count": 0
            },
            {
                "longitude": -74.747769,
                "latitude": 39.671403,
                "address": "156 Wyckoff Avenue, Magnolia, Texas, 4402",
                "phone": "+1 (855) 446-3977",
                "name": "Hines Parking",
                "picture": "http://placehold.it/32x32",
                "count": 1
            },
            {
                "longitude": -74.371718,
                "latitude": 39.162958,
                "address": "407 Seigel Street, Garnet, Massachusetts, 5500",
                "phone": "+1 (817) 569-2550",
                "name": "Mccormick Parking",
                "picture": "http://placehold.it/32x32",
                "count": 2
            },
            {
                "longitude": -74.463565,
                "latitude": 39.75587,
                "address": "696 Martense Street, Valmy, New Jersey, 2555",
                "phone": "+1 (981) 590-2435",
                "name": "Clayton Parking",
                "picture": "http://placehold.it/32x32",
                "count": 3
            },
            {
                "longitude": -74.418149,
                "latitude": 41.178239,
                "address": "572 Chase Court, Limestone, Wisconsin, 6881",
                "phone": "+1 (930) 508-3852",
                "name": "Acevedo Parking",
                "picture": "http://placehold.it/32x32",
                "count": 4
            },
            {
                "longitude": -74.502728,
                "latitude": 39.180707,
                "address": "287 Java Street, Marne, Northern Mariana Islands, 7000",
                "phone": "+1 (812) 461-2178",
                "name": "Holloway Parking",
                "picture": "http://placehold.it/32x32",
                "count": 5
            },
            {
                "longitude": -74.397907,
                "latitude": 39.091877,
                "address": "451 Balfour Place, Blanford, Alaska, 8593",
                "phone": "+1 (875) 406-2828",
                "name": "Hess Parking",
                "picture": "http://placehold.it/32x32",
                "count": 6
            },
            {
                "longitude": -74.308545,
                "latitude": 39.352462,
                "address": "659 Prospect Place, Muir, Utah, 9698",
                "phone": "+1 (863) 554-3140",
                "name": "Mcmahon Parking",
                "picture": "http://placehold.it/32x32",
                "count": 7
            }
        ];
    </script>
    <script type="text/javascript">
        var infowindow = null;
        function initialize() {
            //see styled maps wizard at: http://gmaps-samples-v3.googlecode.com/svn/trunk/styledmaps/wizard/index.html
            infowindow = new google.maps.InfoWindow({
               content: 'Loading...'
            });
            // Custom map pin from SVG
            var customMap = function() {
                var parent = this;
                this.mapStyle = [{
                    "elementType": "geometry.fill",
                    "stylers": [
                        { "visibility": "on" },
                        { "hue": "#0066ff" }
                    ]
                }];

                var stylesConfig = (function (){
                    return parent.mapStyle;
                })(); 
                
                this.mapPin = [{
                    path: 'M24,12c0-6.6-5.4-12-12-12C5.4,0,0,5.4,0,12c0,3.4,3.8,8.7,3.8,8.7L12,31.3l8.1-10.4C20.1,20.9,24,15.5,24,12z',
                    fillColor: 'blue',
                    fillOpacity: 1,
                    scale: 1,
                    strokeColor: 'blue',
                    strokeWeight: 0,
                    strokeOpacity: 1
                }];

                this.mapParkingPin = [{
                    path: 'M9.3,4.7C9.2,4.5,9,4.4,8.7,4.3C8.4,4.1,8.1,4.1,7.8,4.1H5.1v5.8h1.5v-2h1.2c0.4,0,0.7-0.1,0.9-0.2C9,7.7,9.2,7.5,9.3,7.3c0.2-0.2,0.3-0.4,0.4-0.6C9.8,6.5,9.8,6.2,9.8,6c0-0.2,0-0.5-0.1-0.7C9.6,5.1,9.5,4.9,9.3,4.7z M6.6,5.3h0.8c0.1,0,0.3,0,0.4,0c0.1,0,0.2,0.1,0.3,0.1c0.1,0,0.1,0.1,0.2,0.2c0,0.1,0.1,0.2,0.1,0.4c0,0.2,0,0.3-0.1,0.4c0,0.1-0.1,0.2-0.2,0.2C8,6.6,7.9,6.7,7.8,6.7c-0.1,0-0.3,0-0.4,0H6.6V5.3zM7,0C3.1,0,0,3.1,0,7s3.1,7,7,7s7-3.1,7-7S10.9,0,7,0z M7,12.2c-2.9,0-5.2-2.4-5.2-5.2S4.1,1.8,7,1.8s5.2,2.4,5.2,5.2S9.9,12.2,7,12.2z',
                    fillColor: 'blue',
                    fillOpacity: 1,
                    scale: 2,
                    strokeColor: 'blue',
                    strokeWeight: 0,
                    strokeOpacity: 1
                }];

                this.mapOptions = [{
                    center: { lat: 41.3069513, lng: -72.9306178},
                    zoom: 9,
                    disableDefaultUI: true,
                    styles: stylesConfig 
                }];
            };

            // Instantiate
            var myMap = new customMap();

            //map looks for a div with the given name
            var map = new google.maps.Map(document.getElementById('map-canvas'),
                    myMap.mapOptions[0]);

            for(var x in buildings){

                var building = buildings[x];
                    building.infowindow = new google.maps.InfoWindow({
                       content: 'Loading...'
                    });
                    building.location = new google.maps.LatLng(building.latitude,building.longitude);
                    building.marker = new MarkerWithLabel({
                        labelContent: x,
                        labelAnchor: new google.maps.Point(-7,-4),
                        labelClass: "labels",
                        position: building.location,
                        title: building.name,
                        map: map,
                        icon: myMap.mapPin[0],
                        html: (function(building){ 
                            return [
                                '<div class="map-marker">',
                                    '<header>'+ building.name +'</header>',
                                    '<main>'+ building.address +'</main>',
                                    '<footer>'+ building.phone +'</footer>',
                                '</div>'
                            ].join('\n')})(building) 
                    });
            
                building.infowindow.setContent(building.marker.html);
                google.maps.event.addListener(building.marker, 'click', function(){
                   building.infowindow.open(map, this);
                });
                console.log(building);
            }



            for(var x in parking){
                var spot = parking[x];
                    spot.infowindow = new google.maps.InfoWindow({
                       content: 'Loading...'
                    });
                    spot.location = new google.maps.LatLng(spot.latitude,spot.longitude);
                    spot.marker   = new MarkerWithLabel({
                        labelContent: x,
                        labelAnchor: new google.maps.Point(-7,-4),
                        labelClass: "labels",
                        position: spot.location,
                        title: spot.name,
                        map: map,
                        icon: myMap.mapParkingPin[0],
                        html: (function(){ 
                            return [
                                '<div class="map-marker">',
                                    '<header>'+ spot.name +'</header>',
                                    '<main>'+ spot.address +'</main>',
                                    '<footer>'+ spot.phone +'</footer>',
                                '</div>'
                            ].join('\n')})() 
                    });
                spot.infowindow.setContent(spot.marker.html);
                //Adds event listener that invokes InfoWindow
                google.maps.event.addListener(spot.marker, 'click', function(){
                   spot.infowindow.open(map, this);
                });
            }
        }
        // Kick off the initialization script and load the map
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>



<div id="map-canvas"></div>
</body>
</html>